<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Lightweight implementation of Krylov methods using modern Fortran.">
    <meta name="author" content="Jean-Christophe Loiseau, Simon Kern, and Ricardo Frantz" >
    <link rel="icon" href="../favicon.png">

    <title>LightKrylov_NewtonKrylov &ndash; LightKrylov</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
      <link href="../css/user.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">LightKrylov </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../page/index.html">Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>LightKrylov_NewtonKrylov
      <small>Module</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">
            <li class="list-inline-item" id="meta-license"><i class="fa fa-legal"></i> <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a></li>

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 7.3% of total for modules and submodules.">1052 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/NewtonKrylov.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/newtonkrylov.f90.html'>NewtonKrylov.f90</a></li>
            <li class="breadcrumb-item active" aria-current="page">LightKrylov_NewtonKrylov</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3">
        <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#inters-0"
         aria-expanded="false" aria-controls="inters-0">
         <h4 class="card-header bg-primary text-white">Interfaces</h4>
      </a>
      <div id="inters-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#interface-newton">newton</a>
        </div>
      </div>
    </div>

  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#types-0"
         aria-expanded="false" aria-controls="types-0">
         <h4 class="card-header bg-primary text-white">Derived Types</h4>
      </a>
      <div id="types-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#type-newton_dp_metadata">newton_dp_metadata</a>
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#type-newton_dp_opts">newton_dp_opts</a>
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#type-newton_sp_metadata">newton_sp_metadata</a>
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#type-newton_sp_opts">newton_sp_opts</a>
        </div>
      </div>
    </div>

  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#proc-constant_tol_dp">constant_tol_dp</a>
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#proc-constant_tol_sp">constant_tol_sp</a>
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#proc-dynamic_tol_dp">dynamic_tol_dp</a>
            <a class="list-group-item" href="../module/lightkrylov_newtonkrylov.html#proc-dynamic_tol_sp">dynamic_tol_sp</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  


  </div>

    </div>

    <div class="col-md-9" id='text'>
      
<br>          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item"><a href='lightkrylov_iterativesolvers.html'>LightKrylov_IterativeSolvers</a></li>
                  <li class="list-inline-item"><a href='lightkrylov_logger.html'>LightKrylov_Logger</a></li>
                  <li class="list-inline-item"><a href='lightkrylov_timing.html'>LightKrylov_Timing</a></li>
                  <li class="list-inline-item"><a href='lightkrylov_utils.html'>LightKrylov_Utils</a></li>
                  <li class="list-inline-item"><a href='lightkrylov_abstractlinops.html'>LightKrylov_AbstractLinops</a></li>
                  <li class="list-inline-item">stdlib_optval</li>
                  <li class="list-inline-item"><a href='lightkrylov_abstractvectors.html'>LightKrylov_AbstractVectors</a></li>
                  <li class="list-inline-item"><a href='lightkrylov_abstractsystems.html'>LightKrylov_AbstractSystems</a></li>
                  <li class="list-inline-item"><a href='lightkrylov_constants.html'>LightKrylov_Constants</a></li>
                  <li class="list-inline-item">stdlib_strings</li>
              </ul>
            </li>
        </ul>
      </div>
    </div>

      
      <br>




        <section>
          <h2>Interfaces</h2>
              <div class="card">
    <div class="card-header bg-light codesum">
      <span class="anchor" id="interface-newton"></span>
      <h3>public        interface <a href='../interface/newton.html'>newton</a> 
      </h3>
    </div>
      <div class="card-body">
        <p>Implements the simple Newton-Krylov method for finding roots (fixed points) of a 
nonlinear vector-valued function <script type="math/tex"> F(\mathbf{X}) </script>, i.e. solutions <script type="math/tex"> \mathbf{X}^* </script> 
such that <script type="math/tex"> F(\mathbf{X}^*) - \mathbf{X}^* = \mathbf{0} </script> starting from an 
initial guess via successive solution increments based on local linearization 
<script type="math/tex"> \mathbf{J}_\mathbf{X} </script> (the Jacobian) of the nonlinear function in the 
vicinity of the current solution.</p>
<p><strong>Algorthmic Features</strong></p>
<ul>
<li>At iteration <script type="math/tex">k</script>, the standard Newton step <script type="math/tex"> \mathbf{\delta x}_k</script> is 
  computed as the solution of the linear system</li>
</ul>
<p>
<script type="math/tex; mode=display"> \mathbf{J}_\mathbf{X_k} \mathbf{\delta x}_k = \mathbf{r}_k </script>
</p>
<p>where <script type="math/tex"> \mathbf{r}_k = -F(\mathbf{X}_k) </script> is the residual of the nonlinear 
  function. The new guess for the fixed point is then given by:</p>
<p>
<script type="math/tex; mode=display"> \mathbf{X}_{k+1} = \mathbf{X}_k + \alpha \mathbf{\delta x}_k</script>
</p>
<p>where <script type="math/tex"> \alpha \in \left( 0, 1 \right] </script> parametrizes the step length. The 
  standard Newton algorithm sets <script type="math/tex"> \alpha = 1 </script>.</p>
<ul>
<li>The Jacobian is never assembled and the linear system is solved using one of 
  the available iterative solvers.</li>
<li>When the residual norm does not decrease during iteration indicating that the 
  linearization is not a very accurate model of the function's behaviour, which 
  often happens during the initial iterations, a 1D step bisection method based 
  on the golden ratio is implemented to dampen the step and improve convergence 
  of the method.</li>
<li>The implementation allows for dynamic tolerances (also known as inexact Newton), 
  where the approximation for the residual and the linear system can be solved 
  with relaxed tolerances to reduce overall time to solution.</li>
<li>The method is suitable to both fixed points and periodic orbits via the choice 
  of residual and corresponding Jacobian matrix. In the case of unforced periodic 
  orbits, the period is itself an unknown that must be included in the iteration.</li>
</ul>
<p><strong>Advantages</strong></p>
<ul>
<li>The iterative solution of the linear systems has a comparatively low storage 
  footprint.</li>
<li>If the Newton iteration converges, the convergence is formally asymptotically 
  of second order. Using dynamic tolerances and line searches slightly reduce 
  this convergence rate in exchange for a larger convergence region.</li>
</ul>
<p><strong>Limitations</strong></p>
<ul>
<li>The method is not guaranteed to converge if the initial guess is too far from 
  the fixed point. If the Newton iteration diverges even with step bisection, 
  the best suggestion is to find a better initial guess. If this is not feasible, 
  some alternatives to improve the convergence of the Newton iteration are possible 
  (but not implemented to date), including various line search algorithms and trust 
  region methods (doglog, double dogleg, hookstep, ...).</li>
</ul>
<p><strong>References</strong></p>
<ul>
<li>Sánchez, J., Net, M., Garcıa-Archilla, B., &amp; Simó, C. (2004). "Newton–Krylov 
  continuation of periodic orbits for Navier–Stokes flows". Journal of Computational 
  Physics, 201(1), 13-33.</li>
<li>Viswanath, D. (2007). "Recurrent motions within plane Couette turbulence". 
  Journal of Fluid Mechanics, 580, 339-358. </li>
<li>Duguet, Y., Pringle, C. C. T., Kerswell, R. R. (2008). "Relative periodic orbits 
  in transitional pipe flow". Physics  of Fluids, 20(11), 114102.</li>
<li>Frantz, R. A., Loiseau, J. C., &amp; Robinet, J. C. (2023). "Krylov methods for 
  large-scale dynamical systems: Application in fluid dynamics". Applied Mechanics
  Reviews, 75(3), 030802.</li>
</ul>
      </div>
    <ul class="list-group">
          <li class="list-group-item">
                <h3>
    private  subroutine newton_rsp(sys, X, solver, info, rtol, atol, options, linear_solver_options, preconditioner, scheduler, meta)  

    </h3>
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-sys"></span>
              class(<a href='../type/abstract_system_rsp.html'>abstract_system_rsp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys</strong></td>
            <td>
                <p>Dynamical system for which we wish to compute a fixed point</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x"></span>
              class(<a href='../type/abstract_vector_rsp.html'>abstract_vector_rsp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong></td>
            <td>
                <p>Initial guess for the fixed point, will be overwritten with solution</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solver"></span>
              procedure(<a href='../interface/abstract_linear_solver_rsp.html'>abstract_linear_solver_rsp</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solver</strong></td>
            <td>
                <p>Linear solver to be used to find Newton step</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~9"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
                <p>Information flag</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol"></span>
              real(kind=sp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atol"></span>
              real(kind=sp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>atol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-options"></span>
              type(<a href='../type/newton_sp_opts.html'>newton_sp_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>options</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-linear_solver_options"></span>
              class(<a href='../type/abstract_opts.html'>abstract_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>linear_solver_options</strong></td>
            <td>
                <p>Options for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-preconditioner"></span>
              class(<a href='../type/abstract_precond_rsp.html'>abstract_precond_rsp</a>),
            </td>
<td>intent(inout),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>preconditioner</strong></td>
            <td>
                <p>Preconditioner for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scheduler"></span>
              procedure(abstract_scheduler_sp),
            </td>
<td></td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scheduler</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-meta"></span>
              class(<a href='../type/abstract_metadata.html'>abstract_metadata</a>),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>meta</strong></td>
            <td>
                <p>Metadata.</p>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
          <li class="list-group-item">
                <h3>
    private  subroutine newton_rdp(sys, X, solver, info, rtol, atol, options, linear_solver_options, preconditioner, scheduler, meta)  

    </h3>
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-sys~2"></span>
              class(<a href='../type/abstract_system_rdp.html'>abstract_system_rdp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys</strong></td>
            <td>
                <p>Dynamical system for which we wish to compute a fixed point</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~2"></span>
              class(<a href='../type/abstract_vector_rdp.html'>abstract_vector_rdp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong></td>
            <td>
                <p>Initial guess for the fixed point, will be overwritten with solution</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solver~2"></span>
              procedure(<a href='../interface/abstract_linear_solver_rdp.html'>abstract_linear_solver_rdp</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solver</strong></td>
            <td>
                <p>Linear solver to be used to find Newton step</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~10"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
                <p>Information flag</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol~2"></span>
              real(kind=dp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atol~2"></span>
              real(kind=dp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>atol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-options~2"></span>
              type(<a href='../type/newton_dp_opts.html'>newton_dp_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>options</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-linear_solver_options~2"></span>
              class(<a href='../type/abstract_opts.html'>abstract_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>linear_solver_options</strong></td>
            <td>
                <p>Options for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-preconditioner~2"></span>
              class(<a href='../type/abstract_precond_rdp.html'>abstract_precond_rdp</a>),
            </td>
<td>intent(inout),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>preconditioner</strong></td>
            <td>
                <p>Preconditioner for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scheduler~2"></span>
              procedure(abstract_scheduler_dp),
            </td>
<td></td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scheduler</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-meta~2"></span>
              class(<a href='../type/abstract_metadata.html'>abstract_metadata</a>),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>meta</strong></td>
            <td>
                <p>Metadata.</p>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
          <li class="list-group-item">
                <h3>
    private  subroutine newton_csp(sys, X, solver, info, rtol, atol, options, linear_solver_options, preconditioner, scheduler, meta)  

    </h3>
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-sys~3"></span>
              class(<a href='../type/abstract_system_csp.html'>abstract_system_csp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys</strong></td>
            <td>
                <p>Dynamical system for which we wish to compute a fixed point</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~3"></span>
              class(<a href='../type/abstract_vector_csp.html'>abstract_vector_csp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong></td>
            <td>
                <p>Initial guess for the fixed point, will be overwritten with solution</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solver~3"></span>
              procedure(<a href='../interface/abstract_linear_solver_csp.html'>abstract_linear_solver_csp</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solver</strong></td>
            <td>
                <p>Linear solver to be used to find Newton step</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~11"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
                <p>Information flag</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol~3"></span>
              real(kind=sp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atol~3"></span>
              real(kind=sp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>atol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-options~3"></span>
              type(<a href='../type/newton_sp_opts.html'>newton_sp_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>options</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-linear_solver_options~3"></span>
              class(<a href='../type/abstract_opts.html'>abstract_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>linear_solver_options</strong></td>
            <td>
                <p>Options for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-preconditioner~3"></span>
              class(<a href='../type/abstract_precond_csp.html'>abstract_precond_csp</a>),
            </td>
<td>intent(inout),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>preconditioner</strong></td>
            <td>
                <p>Preconditioner for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scheduler~3"></span>
              procedure(abstract_scheduler_sp),
            </td>
<td></td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scheduler</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-meta~3"></span>
              class(<a href='../type/abstract_metadata.html'>abstract_metadata</a>),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>meta</strong></td>
            <td>
                <p>Metadata.</p>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
          <li class="list-group-item">
                <h3>
    private  subroutine newton_cdp(sys, X, solver, info, rtol, atol, options, linear_solver_options, preconditioner, scheduler, meta)  

    </h3>
  

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-sys~4"></span>
              class(<a href='../type/abstract_system_cdp.html'>abstract_system_cdp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>sys</strong></td>
            <td>
                <p>Dynamical system for which we wish to compute a fixed point</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-x~4"></span>
              class(<a href='../type/abstract_vector_cdp.html'>abstract_vector_cdp</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>X</strong></td>
            <td>
                <p>Initial guess for the fixed point, will be overwritten with solution</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-solver~4"></span>
              procedure(<a href='../interface/abstract_linear_solver_cdp.html'>abstract_linear_solver_cdp</a>)
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>solver</strong></td>
            <td>
                <p>Linear solver to be used to find Newton step</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~12"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
                <p>Information flag</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rtol~4"></span>
              real(kind=dp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rtol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-atol~4"></span>
              real(kind=dp),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>atol</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-options~4"></span>
              type(<a href='../type/newton_dp_opts.html'>newton_dp_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>options</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-linear_solver_options~4"></span>
              class(<a href='../type/abstract_opts.html'>abstract_opts</a>),
            </td>
<td>intent(in),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>linear_solver_options</strong></td>
            <td>
                <p>Options for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-preconditioner~4"></span>
              class(<a href='../type/abstract_precond_cdp.html'>abstract_precond_cdp</a>),
            </td>
<td>intent(inout),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>preconditioner</strong></td>
            <td>
                <p>Preconditioner for the linear solver</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-scheduler~4"></span>
              procedure(abstract_scheduler_dp),
            </td>
<td></td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>scheduler</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-meta~4"></span>
              class(<a href='../type/abstract_metadata.html'>abstract_metadata</a>),
            </td>
<td>intent(out),</td>
              <td>optional</td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>meta</strong></td>
            <td>
                <p>Metadata.</p>
            </td>
        </tr>
    </tbody>
  </table>


          </li>
    </ul>
  </div>

        </section>
        <br>


        <section>
          <h2>Derived Types</h2>
              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-newton_dp_metadata"></span>
      <h3>
        type, public, extends(<a href='../type/abstract_metadata.html'>abstract_metadata</a>)&nbsp;::&nbsp;
        <a href='../type/newton_dp_metadata.html'>newton_dp_metadata</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Metadata for Newton-Krylov fixed-point iteration.</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-converged~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>converged</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Convergence flag</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eval_counter_record~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eval_counter_record</strong></td>
<td> =</td>
                <td>0</td>
            <td>
<p>System response evaluation counter:
N.B.: For each of these evals the current residual and tolerance are recorded.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~6"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
<td> =</td>
                <td>0</td>
            <td>
<p>Copy of the information flag for completeness</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-input_is_fixed_point~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>input_is_fixed_point</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Flag indicating lucky convergence (Newton is not run and no solution is computed)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_iter~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_iter</strong></td>
<td> =</td>
                <td>0</td>
            <td>
<p>Iteration counter</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-res~2"></span>
              real(kind=dp),
            </td>
              <td>public,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>res</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Residual history</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~2"></span>
              real(kind=dp),
            </td>
              <td>public,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Tolerance history</p>
            </td>
        </tr>
    </tbody>
  </table>




        <h4>Type-Bound Procedures</h4>
        <table class="table table-striped varlist">
          <tbody>
              <tr>
                <td>  procedure, public, pass(self) ::
  <strong><a href='../type/newton_dp_metadata.html#boundprocedure-print~2'>print</a></strong> => print_newton_dp</td>
                  <td></td>
              </tr>
              <tr>
                <td>  procedure, public, pass(self) ::
  <strong><a href='../type/newton_dp_metadata.html#boundprocedure-record~2'>record</a></strong> => record_data_dp</td>
                  <td></td>
              </tr>
              <tr>
                <td>  procedure, public, pass(self) ::
  <strong><a href='../type/newton_dp_metadata.html#boundprocedure-reset~2'>reset</a></strong> => reset_newton_dp</td>
                  <td></td>
              </tr>
          </tbody>
        </table>
    </div>
  </div>

              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-newton_dp_opts"></span>
      <h3>
        type, public, extends(<a href='../type/abstract_opts.html'>abstract_opts</a>)&nbsp;::&nbsp;
        <a href='../type/newton_dp_opts.html'>newton_dp_opts</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Options for Newton-Krylov fixed-point iteration.</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-if_print_metadata~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>if_print_metadata</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Print interation metadata on exit (default = .false.)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ifbisect~2"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ifbisect</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Bisection toggle to enforce residual reduction (default = .false.)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxiter~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxiter</strong></td>
<td> =</td>
                <td>100</td>
            <td>
<p>Maximum number of Newton iterations (default = 100)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxstep_bisection~2"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxstep_bisection</strong></td>
<td> =</td>
                <td>5</td>
            <td>
<p>Maximum number of bisections (evaluations of F) for step selection (default = 5)
Ignored if ifbisect = .false.</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-newton_sp_metadata"></span>
      <h3>
        type, public, extends(<a href='../type/abstract_metadata.html'>abstract_metadata</a>)&nbsp;::&nbsp;
        <a href='../type/newton_sp_metadata.html'>newton_sp_metadata</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Metadata for Newton-Krylov fixed-point iteration.</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-converged"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>converged</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Convergence flag</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-eval_counter_record"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>eval_counter_record</strong></td>
<td> =</td>
                <td>0</td>
            <td>
<p>System response evaluation counter:
N.B.: For each of these evals the current residual and tolerance are recorded.</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~5"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
<td> =</td>
                <td>0</td>
            <td>
<p>Copy of the information flag for completeness</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-input_is_fixed_point"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>input_is_fixed_point</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Flag indicating lucky convergence (Newton is not run and no solution is computed)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-n_iter"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>n_iter</strong></td>
<td> =</td>
                <td>0</td>
            <td>
<p>Iteration counter</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-res"></span>
              real(kind=sp),
            </td>
              <td>public,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>res</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Residual history</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-tol"></span>
              real(kind=sp),
            </td>
              <td>public,</td>
            <td>
              dimension(:), allocatable
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
                <td></td>
                <td></td>
            <td>
<p>Tolerance history</p>
            </td>
        </tr>
    </tbody>
  </table>




        <h4>Type-Bound Procedures</h4>
        <table class="table table-striped varlist">
          <tbody>
              <tr>
                <td>  procedure, public, pass(self) ::
  <strong><a href='../type/newton_sp_metadata.html#boundprocedure-print'>print</a></strong> => print_newton_sp</td>
                  <td></td>
              </tr>
              <tr>
                <td>  procedure, public, pass(self) ::
  <strong><a href='../type/newton_sp_metadata.html#boundprocedure-record'>record</a></strong> => record_data_sp</td>
                  <td></td>
              </tr>
              <tr>
                <td>  procedure, public, pass(self) ::
  <strong><a href='../type/newton_sp_metadata.html#boundprocedure-reset'>reset</a></strong> => reset_newton_sp</td>
                  <td></td>
              </tr>
          </tbody>
        </table>
    </div>
  </div>

              <div class="card">
    <div class="card-header codesum">
      <span class="anchor" id="type-newton_sp_opts"></span>
      <h3>
        type, public, extends(<a href='../type/abstract_opts.html'>abstract_opts</a>)&nbsp;::&nbsp;
        <a href='../type/newton_sp_opts.html'>newton_sp_opts</a>
        
      </h3>
    </div>
    <div class="card-body">
      <p>Options for Newton-Krylov fixed-point iteration.</p>

        <h4>Components</h4>
          <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-if_print_metadata"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>if_print_metadata</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Print interation metadata on exit (default = .false.)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ifbisect"></span>
              logical,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>ifbisect</strong></td>
<td> =</td>
                <td>.false.</td>
            <td>
<p>Bisection toggle to enforce residual reduction (default = .false.)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxiter"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxiter</strong></td>
<td> =</td>
                <td>100</td>
            <td>
<p>Maximum number of Newton iterations (default = 100)</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-maxstep_bisection"></span>
              integer,
            </td>
              <td>public</td>
            <td>
              
            </td>
            <td>::</td>
            <td><strong>maxstep_bisection</strong></td>
<td> =</td>
                <td>5</td>
            <td>
<p>Maximum number of bisections (evaluations of F) for step selection (default = 5)
Ignored if ifbisect = .false.</p>
            </td>
        </tr>
    </tbody>
  </table>




    </div>
  </div>

        </section>
        <br>


        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-constant_tol_dp"></span> <h3>public  subroutine <a href='../proc/constant_tol_dp.html'>constant_tol_dp</a>(tol, target_tol, rnorm, iter, info)  
</h3></div>
    <div class="card-body">
          
  <p>Constant tolerance scheduler for the Newton iteration</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~17"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
            <td>
<p>Tolerance to be used</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-target_tol~9"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>target_tol</strong></td>
            <td>
<p>Target tolerance</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rnorm~9"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rnorm</strong></td>
            <td>
<p>Norm of the residual of the current iterate</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iter~5"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iter</strong></td>
            <td>
<p>Newton iteration count</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~15"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
<p>Information flag</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-constant_tol_sp"></span> <h3>public  subroutine <a href='../proc/constant_tol_sp.html'>constant_tol_sp</a>(tol, target_tol, rnorm, iter, info)  
</h3></div>
    <div class="card-body">
          
  <p>Constant tolerance scheduler for the Newton iteration</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~15"></span>
              real(kind=sp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
            <td>
<p>Tolerance to be used</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-target_tol~7"></span>
              real(kind=sp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>target_tol</strong></td>
            <td>
<p>Target tolerance</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rnorm~7"></span>
              real(kind=sp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rnorm</strong></td>
            <td>
<p>Norm of the residual of the current iterate</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iter~3"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iter</strong></td>
            <td>
<p>Newton iteration count</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~13"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
<p>Information flag</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-dynamic_tol_dp"></span> <h3>public  subroutine <a href='../proc/dynamic_tol_dp.html'>dynamic_tol_dp</a>(tol, target_tol, rnorm, iter, info)  
</h3></div>
    <div class="card-body">
          
  <p>Dynamic tolerance scheduler for the Newton iteration setting tol based on the current residual tol</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~18"></span>
              real(kind=dp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
            <td>
<p>Tolerance to be used</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-target_tol~10"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>target_tol</strong></td>
            <td>
<p>Target tolerance</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rnorm~10"></span>
              real(kind=dp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rnorm</strong></td>
            <td>
<p>Norm of the residual of the current iterate</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iter~6"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iter</strong></td>
            <td>
<p>Newton iteration count</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~16"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
<p>Information flag</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-dynamic_tol_sp"></span> <h3>public  subroutine <a href='../proc/dynamic_tol_sp.html'>dynamic_tol_sp</a>(tol, target_tol, rnorm, iter, info)  
</h3></div>
    <div class="card-body">
          
  <p>Dynamic tolerance scheduler for the Newton iteration setting tol based on the current residual tol</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-tol~16"></span>
              real(kind=sp),
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>tol</strong></td>
            <td>
<p>Tolerance to be used</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-target_tol~8"></span>
              real(kind=sp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>target_tol</strong></td>
            <td>
<p>Target tolerance</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rnorm~8"></span>
              real(kind=sp),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rnorm</strong></td>
            <td>
<p>Norm of the residual of the current iterate</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-iter~4"></span>
              integer,
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iter</strong></td>
            <td>
<p>Newton iteration count</p>
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-info~14"></span>
              integer,
            </td>
<td>intent(out)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>info</strong></td>
            <td>
<p>Information flag</p>
            </td>
        </tr>
    </tbody>
  </table>


    </div>
  </div>

        </section>
        <br>



    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              LightKrylov
 was developed by Jean-Christophe Loiseau, Simon Kern, and Ricardo Frantz<br>              &copy; 2026 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>