<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Lightweight implementation of Krylov methods using modern Fortran.">
    <meta name="author" content="Jean-Christophe Loiseau, Simon Kern, and Ricardo Frantz" >
    <link rel="icon" href="../../favicon.png">

    <title>Roessler system &ndash; LightKrylov</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../../css/fontawesome.min.css" rel="stylesheet">
    <link href="../../css/brands.min.css" rel="stylesheet">
    <link href="../../css/regular.min.css" rel="stylesheet">
    <link href="../../css/solid.min.css" rel="stylesheet">
    <link href="../../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../../css/local.css" rel="stylesheet">
    <link href="../../css/pygments.css" rel="stylesheet">
      <link href="../../css/user.css" rel="stylesheet">
    <script src="../../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../../index.html">LightKrylov </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="../index.html">Overview</a></li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../../lists/types.html">Derived Types</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>Roessler system</h1>
    <div class="container p-2 mb-4 bg-light border rounded-3">
      <div class="row align-items-center justify-content-between">
        <div class="col">
          <ul class="list-inline" style="margin-bottom:0px; display:inline">
          </ul>
        </div>
        <div class="col">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../index.html'>Overview</a></li>
                <li class="breadcrumb-item"><a href='index.html'>Examples</a></li>
              <li class="breadcrumb-item active" aria-current="page">Roessler system</li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-3">
        <div class="card card-body bg-light" id="sidebar-toc">
          <ul class="nav flex-column align-items">
            <li class="nav-item">
              <a class="nav-link" href="../index.html">Overview</a>
            </li>
          </ul>
          <hr>
          <nav class="nav nav-pills flex-column">
              <a class="nav-link" href="index.html">Examples</a>
                <nav class="nav nav-pills flex-column">
                                <a class="nav-link" href="ginzburg-landau.html">Ginzburg-Landau</a>
              <a class="nav-link active disabled" href="roessler.html">Roessler system</a>

                </nav>
          </nav>
        </div>
      </div>

    <div class="col-9" id='text'>
      <h1 id="periodic-orbits-and-their-stability-on-the-chaotic-roessler-attractor"><strong>Periodic orbits and their stability on the chaotic Roessler attractor</strong></h1>
<p>The Roessler system is a system of three non-linear ordinary differential equations given by
<script type="math/tex; mode=display">
\left\{
\begin{array}{l}
\dot{X} = -Y -Z \\
\dot{Y} = X + aY \\
\dot{Z} = b + Z(X - c)
\end{array}
\right.
</script>
The three input parameters <script type="math/tex"> a, b, c \in \mathbb{R} </script> define the systems regime. The Roessler system is a well-studied example of a continuous-time dynamical system that exhibits many features also found in more complicated systems of practical significance, namely stable and unstable fixed points, periodic orbits as well as chaotic behaviour, i.e. extreme sensitivity to initial conditions [<a href="doi:10.1016/0375-9601(76)90101-8">1</a>,<a href="\https://ChaosBook.org">2</a>].</p>
<p>For the present example, we choose the standard input parameters
<script type="math/tex; mode=display">
\begin{aligned}
a = 0.2 \\
b = 0.2 \\
c = 5.7 \\
\end{aligned}
</script>
for which the system dynamics give rise to the Roessler attractor with a fractal structure due to the chaotic behaviour of the system. To analyse the dynamics, we consider the linearised dynamics of the Roessler system around a point <script type="math/tex">\mathbf{X} = (X,Y,Z)^T </script>, which are given by
<script type="math/tex; mode=display">
\left\{
\begin{array}{l}
\dot{x} = -y -z \\
\dot{y} = x + ay \\
\dot{z} = xZ + z(X - c)
\end{array}
\right.
</script>
To simplify notation, we will write the nonlinear and linear dynamics as <script type="math/tex"> \dot{\mathbf{X}} = F(\mathbf{X}) </script> and <script type="math/tex"> \dot{\mathbf{x}} = f(\mathbf{x}) = \mathbf{J} \: \mathbf{x} </script>, respectively, where the linear operator <script type="math/tex"> \mathbf{J} </script> (also called Jacobian) encapsulates the above linear dynamics.</p>
<p>In the following, we will illustrate the techniques to compute periodic orbits of dynamical system using the iterative Newton-Krylov fixed-point iteration and different methods to analyse their local and global stability, namely the computation of the eigenvalues of the monodromy matrix and Lyapunov exponents as well as the Optimally Time-Dependent mode framework.</p>
<p><strong>Newton-Krylov fixed-point iteration -</strong> A fixed point <script type="math/tex">\mathbf{X}^* </script> of a dynamical system is an equilibrium point that satisfies <script type="math/tex"> \dot{\mathbf{X}}^* = 0 </script>. Periodic orbits are a second kind of equilibrium point that are characterised by repeating dynamics with a constant period <script type="math/tex">T</script> such that <script type="math/tex"> \mathbf{X}(t + T) = \mathbf{X}(t) </script>, which can also be seen as fixed points of the forward map <script type="math/tex"> \mathbf{\Phi}_T </script> defined as 
<script type="math/tex; mode=display">
\mathbf{\Phi}_T = \int_0^T F(\mathbf{X}(t)) \: d t .
</script>
</p>
<p>The Newton-Krylov fixed-point iteration is a Jacobian-free variant of the classical Newton-Raphson root-finding algorithm that, starting from an initial guess <script type="math/tex"> \mathbf{X}_0 </script> for the root of the nonlinear function <script type="math/tex"> F(\mathbf{X}) </script>, iteratively improves the guess using the rule
<script type="math/tex; mode=display">
\mathbf{X}_{i+1} = \mathbf{X_i} - \mathbf{J}^{-1} F(\mathbf{X_i}) .
</script>
</p>
<p>In order to apply the Newton-Raphson method to find periodic orbits, the unknown orbit period <script type="math/tex">T</script> is included in the state vector <script type="math/tex"> \mathbf{X}_T (X,Y,Z,T)^T </script> together with a new constraint to have a fully determined system and the system Jacobian <script type="math/tex"> \mathbf{J} </script> is replaced by the Monodromy operator <script type="math/tex"> \mathbf{M}_T </script>, which is the linearisation of the forward map <script type="math/tex"> \mathbf{\Phi}_T </script> about a given trajectory and is computed as
<script type="math/tex; mode=display">
\mathbf{M}_T = \int_0^T \mathbf{J}(t) \: dt .
</script>
</p>
<p>In practical applications, the Jacobian and Monodromy operators, if they are known explicitly, are never assembled or otherwise are only available via time-stepper functionalities. In order to extend the Newton-Raphson fixed-point iteration to these cases, we move to the Newton-Krylov fixed point iteration that replaces the direct inversion of the system Jacobian with Krylov-based approximations of the action of the linear operators. The system Jacobian <script type="math/tex"> \mathbf{J}_T </script> that needs to be inverted at each Newton step becomes
<script type="math/tex; mode=display">
\mathbf{J}_T = \begin{pmatrix}
    \mathbf{M}_T - \mathbf{I} & F^T(\mathbf{\Phi}_T(\mathbf{X})) \\
    F^T(\mathbf{X}) & 0
\end{pmatrix} .
</script>
In most applications in fluid mechanics, the discretisation produce systems of very high dimension so that the Newton-Krylov iteration is the only viable option for the computation of periodic orbits. For details and applications of the Newton-Krylov method, the interested reader is refered to [<a href="https://doi.org/10.1016/j.jcp.2004.04.018">3</a>,<a href="https://doi.org/10.1017/S0022112007005459">4</a>,<a href="https://doi.org/10.1063/1.3009874">5</a>,<a href="https://doi.org/10.1115/1.4056808">6</a>] and the references therein.</p>
<p><strong>Numerical setup -</strong> In order to analyse the linear and nonlinear dynamics of the Roessler system, we extend the <code>abstract_system_rdp</code> type together with an integrator for both the linear and nonlinear dynamics around a given nonlinear trajectory using a Runge-Kutta class provided by <a href="https://github.com/jacobwilliams/rklib"><code>rklib</code></a>.</p>
<div class="codehilite"><pre><span></span><code><span class="k">subroutine </span><span class="n">combined_rhs</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="w">    </span><span class="c">! Time-integrator.</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">rk_class</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span>
<span class="w">    </span><span class="c">! Current time.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">)</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">t</span>
<span class="w">    </span><span class="c">! State vector.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">)</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="c">! Time-derivative.</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">wp</span><span class="p">)</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">f</span>

<span class="w">    </span><span class="k">call </span><span class="n">nonlinear_roessler</span><span class="p">(</span><span class="w">            </span><span class="n">x</span><span class="p">(:</span><span class="n">npts</span><span class="p">),</span><span class="w"> </span><span class="n">f</span><span class="p">(:</span><span class="n">npts</span><span class="p">))</span><span class="w">     </span><span class="c">! nonlinear dynamics</span>
<span class="w">    </span><span class="k">call    </span><span class="n">linear_roessler</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">npts</span><span class="o">+</span><span class="mi">1</span><span class="p">:),</span><span class="w"> </span><span class="n">x</span><span class="p">(:</span><span class="n">npts</span><span class="p">),</span><span class="w"> </span><span class="n">f</span><span class="p">(</span><span class="n">npts</span><span class="o">+</span><span class="mi">1</span><span class="p">:))</span><span class="w">   </span><span class="c">! linear dynamics about current point</span>

<span class="w">    </span><span class="k">return</span>
<span class="k">end subroutine </span><span class="n">combined_rhs</span>
</code></pre></div>

<p><strong>Computation of periodic orbits of the Roessler system -</strong> In order to apply the Newton-Krylov formalism to the Roessler system, we define the nonlinear system <code>roessler_upo()</code></p>
<div class="codehilite"><pre><span></span><code><span class="n">sys_jac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">roessler_upo</span><span class="p">()</span>
<span class="n">sys_jac</span><span class="p">%</span><span class="n">jacobian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jacobian</span><span class="p">()</span>
<span class="n">sys_jac</span><span class="p">%</span><span class="n">jacobian</span><span class="p">%</span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bf</span>
</code></pre></div>

<p>where <code>jacobian</code> is a linear operator (extended from the <code>abstract_linop_rdp</code> type) for the Newton-Krylov step calling the <code>combined_rhs</code> integrator and <code>bf</code> is the initial guess <script type="math/tex"> \mathbf{X}_0 </script> for the periodic orbit.</p>
<div class="codehilite"><pre><span></span><code><span class="k">subroutine </span><span class="n">linear_map</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">vec_in</span><span class="p">,</span><span class="w"> </span><span class="n">vec_out</span><span class="p">)</span>
<span class="w">    </span><span class="c">! Linear Operator.</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">jacobian</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">self</span>
<span class="w">    </span><span class="c">! Input vector.</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">abstract_vector_rdp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">vec_in</span>
<span class="w">    </span><span class="c">! Output vector.</span>
<span class="w">    </span><span class="k">class</span><span class="p">(</span><span class="n">abstract_vector_rdp</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">vec_out</span>

<span class="w">    </span><span class="c">! Time-integrator.</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">rks54_class</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">combined_roessler</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">period</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">npts</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pos_in</span><span class="p">,</span><span class="w"> </span><span class="n">pos_out</span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">state_vector</span><span class="p">)</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">vec</span>

<span class="w">    </span><span class="k">select type</span><span class="w"> </span><span class="p">(</span><span class="n">vec_in</span><span class="p">)</span>
<span class="w">    </span><span class="k">type is</span><span class="w"> </span><span class="p">(</span><span class="n">state_vector</span><span class="p">)</span>
<span class="w">        </span><span class="k">select type</span><span class="w"> </span><span class="p">(</span><span class="n">vec_out</span><span class="p">)</span>
<span class="w">        </span><span class="k">type is</span><span class="w"> </span><span class="p">(</span><span class="n">state_vector</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Get the state.</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">pos_in</span><span class="p">(:</span><span class="n">npts</span><span class="p">))</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_period</span><span class="p">(</span><span class="n">self</span><span class="p">%</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">period</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">get_position</span><span class="p">(</span><span class="n">vec_in</span><span class="p">,</span><span class="w"> </span><span class="n">pos_in</span><span class="p">(</span><span class="n">npts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:))</span>
<span class="w">            </span><span class="c">! Initialize integrator.</span>
<span class="w">            </span><span class="k">call </span><span class="n">combined_roessler</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">npts</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="o">=</span><span class="n">combined_rhs</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Evaluate:</span>
<span class="w">            </span><span class="c">! 1. F(X)</span>
<span class="w">            </span><span class="c">! 2. exp(tau*J) @ dx</span>
<span class="w">            </span><span class="k">call </span><span class="n">combined_roessler</span><span class="p">%</span><span class="n">integrate</span><span class="p">(</span><span class="mf">0.0_wp</span><span class="p">,</span><span class="w"> </span><span class="n">pos_in</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">period</span><span class="p">,</span><span class="w"> </span><span class="n">pos_out</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Pass-back the state.</span>
<span class="w">            </span><span class="k">call </span><span class="n">set_position</span><span class="p">(</span><span class="n">pos_out</span><span class="p">(</span><span class="n">npts</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">:),</span><span class="w"> </span><span class="n">vec_out</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Evaluate [ exp(tau*J) - I ] @ dx.</span>
<span class="w">            </span><span class="k">call </span><span class="n">vec_out</span><span class="p">%</span><span class="n">sub</span><span class="p">(</span><span class="n">vec_in</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Evaluate f&#39;(X(T), T) * dT and add it to the position residual</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_fdot</span><span class="p">(</span><span class="n">pos_out</span><span class="p">(:</span><span class="n">npts</span><span class="p">),</span><span class="w"> </span><span class="n">vec</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">vec_out</span><span class="p">%</span><span class="n">axpby</span><span class="p">(</span><span class="n">vec_in</span><span class="p">%</span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="n">vec</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Evaluate f&#39;(X(0), 0).T @ dx and add phase condition</span>
<span class="w">            </span><span class="k">call </span><span class="n">compute_fdot</span><span class="p">(</span><span class="n">pos_in</span><span class="p">(:</span><span class="n">npts</span><span class="p">),</span><span class="w"> </span><span class="n">vec</span><span class="p">)</span>
<span class="w">            </span><span class="n">vec_out</span><span class="p">%</span><span class="n">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vec_in</span><span class="p">%</span><span class="n">dot</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span>
<span class="w">        </span><span class="k">class </span><span class="n">default</span>
<span class="w">            </span><span class="k">call </span><span class="n">stop_error</span><span class="p">(</span><span class="s2">&quot;The intent [OUT] argument &#39;vec_out&#39; must be of type &#39;state_vector&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">this_module</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;linear_map&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end select</span>
<span class="k">    class </span><span class="n">default</span>
<span class="w">        </span><span class="k">call </span><span class="n">stop_error</span><span class="p">(</span><span class="s2">&quot;The intent [IN] argument &#39;vec_in&#39; must be of type &#39;state_vector&#39;&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">this_module</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;linear_map&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">end select</span>
<span class="k">end subroutine </span><span class="n">linear_map</span>
</code></pre></div>

<div style="text-align:center;">
    <img src="roessler_chaotic_attractor_and_periodic_orbit.png" style="width:60%;">
    </br>
    <b>Figure: </b> Representation of the chaotic Roessler attractor together with the periodic orbit.
</div>

<p>The fixed point of the forward map is then found with the Newton-Krylov method using the iterative GMRES algorithm to solve the linear system involving the Jacobian.</p>
<p><strong>Stability analysis of the periodic orbit via the Optimally Time-Dependent modes -</strong> In order to analyse the stability properties of the periodic orbit, we can use the Optimally Time-Dependent (OTD) Framework which is a numerically stable algorithm to compute an orthonormal basis of a linear subspace of the tangent space to a nonlinear trajectory spanning the most unstable directions [<a href="https://doi.org/10.1098/rspa.2015.0779">7</a>]. This framework is particularly suited for the analysis of periodic orbits and other time-dependent trajectories since, once the basis is aligned with the most unstable subspace, it optimally follows it as the trajectory evolves. Once this time-dependent orthonormal basis <script type="math/tex"> \mathbf{Q} </script> of used-defined rank <script type="math/tex"> r </script> is computed, the full linearised dynamics <script type="math/tex"> \mathbf{J} </script> can be projected onto the subspace to obtain the reduced operator <script type="math/tex"> \mathbf{J}_r = \mathbf{Q}^T \mathbf{J} \mathbf{Q} </script> containing the dominant dynamics. The theory and implementation of the OTD framework is not reported here for the sake of conciseness. The interested reader is refered to [<a href="https://doi.org/10.1098/rspa.2015.0779">7</a>] for the original paper presenting the method and [<a href="https://doi.org/10.1137/18M1212082">8</a>] and [<a href="https://doi.org/10.1017/jfm.2021.743">9</a>] for extensions and an application to fluid mechanics, respectively.</p>
<p>As the OTD basis converges to and follow the most unstable linear subspace tangent to the trajectory, they are ideally suited for the computation of the Lyapunov exponents, which are often used to characterise the chaotic behaviour of strange attractors. In order to compute the Lyapunov exponents, we integrate the leading eigenvalues of the reduced operator over time [<a href="https://doi.org/10.1137/18M1212082">8</a>]. In this example, we initialise the 2-dimensional OTD basis with random orthonormal vectors and evolve it along the periodic orbit measuring the Lyapunov exponents at each period. As the OTD basis exponentially aligns with the invariant periodic tangent space along the periodic orbit, the approximation of the Lyapunov exponents improves, converging to the reference values from [<a href="https://chaosbook.org/extras/simon/Roessler.html">2</a>].</p>
<div style="text-align:center;">
    <img src="roessler_lyapunov_exponents_OTD.png" style="width:80%;">
    </br>
    <b>Figure:</b> Convergence history of the 2 Lyapunov exponents computed using the OTD basis compared to the reference values [2]. Note that the reference values are known only to 9 digits of precision which is reached after 24 periods.
</div>

<p>From the reduced operator we can compute the instantaneous eigenvalues of the reduced operator <script type="math/tex"> \mathbf{J}_r </script> and the symmetrised reduced operator <script type="math/tex"> \mathbf{J}_{sym} = 0.5(\mathbf{J} + \mathbf{J}^T) </script> measuring modal and nonmodal growth potential, respectively. Projecting the OTD basis onto the eigenvectors of <script type="math/tex"> \mathbf{J}_r </script> yields physically meaningful directions in phase space called OTD modes. </p>
<div style="text-align:center;">
    <img src="roessler_periodic_orbit_OTD.png" style="width:110%;">
    </br>
    <b>Figure:</b> The left panel depicts the chaotic Roessler attractor together with the periodic orbit (traversed in anticlockwise direction). At a few points along the orbit, the converged OTD subspace is plotted (grey surfaces) with the OTD modes (blue arrows) and the direction of maximum linear growth in the OTD subspace (red). The right panel shows the evolution over two periods of the growth rate of the eigenvalues and the numerical abscissa of the converged reduced operator along the invariant periodic tangent space. The vertical dashed line corresponds to the empty circle in the left panel for easier orientation.
</div>

<p>From the root directory of <code>LightKrylov</code>, you can run this example by typing the following command:</p>
<div class="codehilite"><pre><span></span><code>fpm<span class="w"> </span>run<span class="w"> </span>--example<span class="w"> </span>Roessler
</code></pre></div>

<p>Then <code>python plot_roessler.py</code> in the <code>example/roessler</code> directory will produce the plots in this example.</p>
<h2 id="references"><strong>References</strong></h2>
<p>[1] O. E. Roessler. <a href="doi:10.1016/0375-9601(76)90101-8"><em>An Equation for Continuous Chaos</em></a>. Physics Letters, 57A (5), 397–398, 1976.</p>
<p>[2] P. Cvitanovic, R. Artuso, R. Mainieri, G. Tanner and G. Vattay. <a href="\https://ChaosBook.org"><em>Chaos: Classical and Quantum</em></a>. Niels Bohr Institute, Copenhagen 2020.</p>
<p>[3] J. Sánchez, M. Net, B. Garcıa-Archilla, &amp; C. Simó. <a href="https://doi.org/10.1016/j.jcp.2004.04.018"><em>Newton–Krylov continuation of periodic orbits for Navier–Stokes flows</em></a>. Journal of Computational Physics, 201(1), 13-33., 2004.</p>
<p>[4] D. Viswanath. <a href="https://doi.org/10.1017/S0022112007005459"><em>Recurrent motions within plane Couette turbulence</em></a>. Journal of Fluid Mechanics, 580, 339-358, 2007.</p>
<p>[5] Y. Duguet, C. C. T. Pringle, R. R. Kerswell, <a href="https://doi.org/10.1063/1.3009874"><em>Relative periodic orbits in transitional pipe flow</em></a>. Physics of Fluids, 20(11), 114102, 2008.</p>
<p>[6] R. A. Frantz, J.-C. Loiseau, &amp; J.-C. Robinet. <a href="https://doi.org/10.1115/1.4056808"><em>Krylov methods for large-scale dynamical systems: Application in fluid dynamics</em></a>. Applied Mechanics Reviews, 75(3), 030802, 2008.</p>
<p>[7] H. Babaee &amp; T. P. Sapsis. <a href="https://doi.org/10.1098/rspa.2015.0779"><em>A minimization principle for the description of modes associated with finite-time instabilities</em></a>. Proc. R. Soc. London, Ser. A 472, 2016.</p>
<p>[8] A. Blanchard &amp; T. P. Sapsis. <a href="https://doi.org/10.1137/18M1212082"><em>Analytical description of optimally time-dependent modes for reduced-order modeling of transient instabilities</em></a>. SIAM J. Appl. Dyn. Syst. 18 (2), 1143–1162, 2019.</p>
<p>[9] J. S. Kern, M. Beneitez, A. Hanifi &amp; D. S. Henningson. <a href="https://doi.org/10.1017/jfm.2021.743"><em>Transient linear stability of pulsating Poiseuille flow using optimally time-dependent modes.</em></a> J. Fluid Mech. 927, A6., 2021.</p>
    </div>
  </div>
      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              LightKrylov
 was developed by Jean-Christophe Loiseau, Simon Kern, and Ricardo Frantz<br>              &copy; 2026 <a rel="license" href="http://www.freebsd.org/copyright/freebsd-doc-license.html">FreeBSD Documentation License</a>
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>